I"å¼<p><img src="/image/SourceMod/logo.png" alt="image-logo" width="100%" /></p>

<p>HÆ°á»›ng dáº«n nÃ y sáº½ cung cáº¥p cho báº¡n má»™t giá»›i thiá»‡u cÆ¡ báº£n Ä‘á»ƒ viáº¿t má»™t plugin Sourcemod. Náº¿u báº¡n khÃ´ng quen thuá»™c vá»›i ngÃ´n ngá»¯ SourcePawn, Ä‘Ã³ lÃ  khuyáº¿n cÃ¡o ráº±ng báº¡n Ã­t nháº¥t má»™t thá»i gian ngáº¯n Ä‘á»c giá»›i thiá»‡u vá» bÃ i viáº¿t SourcePawn .</p>

<hr />

<p>HÆ°á»›ng dáº«n nÃ y sáº½ cung cáº¥p cho báº¡n má»™t giá»›i thiá»‡u cÆ¡ báº£n Ä‘á»ƒ viáº¿t má»™t plugin Sourcemod. Náº¿u báº¡n khÃ´ng quen thuá»™c vá»›i ngÃ´n ngá»¯ SourcePawn, Ä‘Ã³ lÃ  khuyáº¿n cÃ¡o ráº±ng báº¡n Ã­t nháº¥t má»™t thá»i gian ngáº¯n Ä‘á»c giá»›i thiá»‡u vá» bÃ i viáº¿t SourcePawn.</p>

<p>â€¢ <a href="https://forums.alliedmods.net/showthread.php?t=259917">SpEdit</a> <code class="highlighter-rouge">KhuyÃªn dÃ¹ng vÃ¬ nÃ³ gáº§n nhÆ° Ä‘áº§y Ä‘á»§ tá»« file compile.exe Ä‘áº¿n thÆ° viá»‡n viáº¿t plugins SourceMod</code><br />
 â€¢ <a href="https://www.crimsoneditor.com/">Crimsion Editor</a><br />
 â€¢ <a href="http://www.pspad.com/">PsPad</a><br />
 â€¢ <a href="http://www.ultraedit.com/">UltraEdit</a><br />
 â€¢ <a href="https://notepad-plus-plus.org/">Notepad++</a><br />
 â€¢ <a href="https://www.textpad.com/">TextPad</a><br />
 â€¢ <a href="http://sourceforge.net/projects/pawnstudio/">Pawn Studio</a><br />
 â€¢ <a href="https://forums.alliedmods.net/showthread.php?t=289127">BasicPawn</a><br />
 â€¢ VÃ  má»™t sá»‘ trÃ¬nh biÃªn soáº¡n khÃ¡câ€¦<br /></p>
<hr />

<h2 id="1giá»›i-thiá»‡u-1-chÃºt-vá»-spedit">1.Giá»›i thiá»‡u 1 chÃºt vá» <a href="https://forums.alliedmods.net/showthread.php?t=259917"><strong><code class="highlighter-rouge">SpEdit</code></strong></a></h2>
<hr />

<center><img class="img-thumbnail image-post" src="/image/SourceMod/logoSpEdit.png" /></center>
<p><br />
Má»Ÿ trÃ¬nh biÃªn dá»‹ch SpEdit.exe lÃªn vÃ  khá»Ÿi táº¡o má»™t file cÃ³ Ä‘uÃ´i lÃ  .sp vÃ­ dá»¥ untitle.sp
Khai bÃ¡o thÆ° viá»‡n nhÆ° C/C++ sáº½ cÃ³ lá»‡nh nhÆ° sau: <strong><code class="highlighter-rouge">#include 'tÃªn file nguá»“n'</code></strong>. Äá»ƒ trÃ¬nh biÃªn soáº¡n dáº«n vÃ  Ä‘á»c file nguá»“n Ä‘á»ƒ ghi nhá»› cÃ¢u lá»‡nh.</p>

<h2 id="2thiáº¿t-láº­p-thÃ´ng-tin-cho-plugins">2.Thiáº¿t láº­p thÃ´ng tin cho plugins</h2>
<hr />

<p>BÃ¢y giá» chÃºng ta Ä‘Ã£ cÃ³ quyá»n truy cáº­p vÃ o cÃ¡c tÃ­nh nÄƒng cá»§a SourceMod, Ä‘Ã£ Ä‘áº¿n lÃºc thiáº¿t láº­p thÃ´ng tin sáº½ Ä‘Æ°á»£c hiá»ƒn thá»‹ thÃ´ng qua lá»‡nh sm plugins list. KhÃ´ng ai thÃ­ch cÃ¡c plugin khÃ´ng tÃªn.</p>

<p>Äá»ƒ lÃ m Ä‘iá»u Ä‘Ã³, chÃºng ta sáº½ xem xÃ©t bÃªn trong tá»‡p <strong><code class="highlighter-rouge">sourcemod.inc</code></strong> vÃ  xem Ä‘á»‹nh dáº¡ng thÃ´ng tin sáº½ Ä‘Æ°á»£c khai bÃ¡o.</p>

<p>LuÃ´n luÃ´n há»¯u Ã­ch khi xem bÃªn trong SM bao gá»“m cÃ¡c tá»‡p Ä‘á»ƒ tÃ¬m hiá»ƒu thÃ´ng tin báº¡n khÃ´ng biáº¿t. NgoÃ i ra cÃ²n cÃ³ má»™t tÃ i liá»‡u API nhÆ°ng nÃ³ cÃ³ thá»ƒ bá»‹ lá»—i thá»i vÃ  nÃ³ chá»‰ cÃ³ cÃ¡c tá»‡p lÃµi SM nÃªn náº¿u plugin cá»§a báº¡n sáº½ sá»­ dá»¥ng báº¥t ká»³ tiá»‡n Ã­ch má»Ÿ rá»™ng cá»§a bÃªn thá»© ba hoáº·c plugin nÃ o khÃ¡c, <strong><code class="highlighter-rouge">báº¡n sáº½ pháº£i nghiÃªn cá»©u cÃ¡c file inc</code></strong>.</p>

<p>VÃ¬ váº­y, hÃ£y má»Ÿ <strong><code class="highlighter-rouge">sourcemod.inc</code></strong> vÃ  cuá»™n xuá»‘ng má»™t chÃºt cho Ä‘áº¿n khi báº¡n tháº¥y Ä‘iá»u nÃ y:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="c1">// Plugin public information.</span>
    <span class="n">struct</span> <span class="nc">Plugin</span>
    <span class="o">{</span>
        <span class="kd">public</span> <span class="kd">const</span> <span class="kt">char</span><span class="o">[]</span> <span class="n">name</span><span class="o">;</span>                  <span class="cm">/**&lt; TÃªn Plugin */</span>
        <span class="kd">public</span> <span class="kd">const</span> <span class="kt">char</span><span class="o">[]</span> <span class="n">description</span>            <span class="cm">/**&lt; MÃ´ táº£ Plugin */</span>
        <span class="kd">public</span> <span class="kd">const</span> <span class="kt">char</span><span class="o">[]</span> <span class="n">author</span><span class="o">;</span>              <span class="cm">/**&lt; TÃ¡c giáº£ viáº¿t Plugin */</span>
        <span class="kd">public</span> <span class="kd">const</span> <span class="kt">char</span><span class="o">[]</span> <span class="n">version</span><span class="o">;</span>             <span class="cm">/**&lt; PhiÃªn báº£n Plugin */</span>
        <span class="kd">public</span> <span class="kd">const</span> <span class="kt">char</span><span class="o">[]</span> <span class="n">url</span><span class="o">;</span>                <span class="cm">/**&lt; Link Nguá»“n Plugin */</span>
    <span class="o">};</span>

</code></pre></div></div>
<p>vÃ  Ä‘Ã¢y:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="cm">/*
        * Khai bÃ¡o Ä‘Ã¢y lÃ  má»™t cáº¥u trÃºc trong plugin cá»§a báº¡n Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng tin cá»§a nÃ³.
        * VÃ­ dá»¥
        */</span>

    <span class="kd">public</span> <span class="nc">Plugin</span> <span class="n">myinfo</span> <span class="o">=</span>
    <span class="o">{</span>
        <span class="n">name</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ten_plugin</span><span class="o">&gt;;</span>
        <span class="c1">//tiáº¿p... </span>
    <span class="o">}</span>

</code></pre></div></div>
<p>NÃ³ cho chÃºng ta biáº¿t ráº±ng chÃºng ta cáº§n táº¡o má»™t biáº¿n <strong><code class="highlighter-rouge">public Plugin myinfo</code></strong>, biáº¿n nÃ y pháº£i thuá»™c loáº¡i Plugin, lÃ  má»™t cáº¥u trÃºc cÃ³ 5 trÆ°á»ng mÃ  vÃ  thuá»™c kiá»ƒu dá»¯ liá»‡u lÃ  cÃ¡c chuá»—i.</p>

<p>Nghe cÃ³ váº» phá»©c táº¡p Ä‘á»‘i vá»›i ngÆ°á»i má»›i báº¯t Ä‘áº§u nhÆ°ng ráº¥t dá»… dÃ ng. HÃ£y tiáº¿p tá»¥c vÃ  táº¡o má»™t cÃ¡i:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="err">#</span><span class="n">include</span> <span class="o">&lt;</span><span class="n">sourcemod</span><span class="o">&gt;</span>
    
    <span class="kd">public</span> <span class="nc">Plugin</span> <span class="n">myinfo</span> <span class="o">=</span>
    <span class="o">{</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"My First Plugin"</span><span class="o">,</span>
        <span class="n">author</span> <span class="o">=</span> <span class="s">"Me"</span><span class="o">,</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s">"My first plugin ever"</span><span class="o">,</span>
        <span class="n">version</span> <span class="o">=</span> <span class="s">"1.0"</span><span class="o">,</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s">"http://www.sourcemod.net/"</span>
    <span class="o">};</span>

</code></pre></div></div>

<h2 id="3báº¯t-mÃ£-Ä‘á»ƒ-cháº¡y">3.Báº¯t mÃ£ Ä‘á»ƒ cháº¡y</h2>
<hr />

<p>chÃºng ta Ä‘Ã£ bao gá»“m cÃ¡c tÃ­nh nÄƒng cá»§a SourceMod vÃ  thÃ´ng tin bá»• sung hoáº·c plugin. BÃ¢y giá» chÃºng ta cÃ³ má»™t plugin Ä‘Æ°á»£c Ä‘á»‹nh dáº¡ng hoÃ n háº£o cÃ³ thá»ƒ Ä‘Æ°á»£c biÃªn dá»‹ch vÃ  táº£i bá»Ÿi SourceMod.</p>

<p>Tuy nhiÃªn, cÃ³ má»™t váº¥n Ä‘á» - nÃ³ khÃ´ng lÃ m gÃ¬ cáº£. Báº¡n cÃ³ thá»ƒ báº¯t Ä‘áº§u viáº¿t mÃ£ sau khai bÃ¡o <strong><code class="highlighter-rouge">myinfo</code></strong> chá»‰ Ä‘á»ƒ tháº¥y ráº±ng nÃ³ sáº½ khÃ´ng biÃªn dá»‹ch. <strong><code class="highlighter-rouge">SourcePawn</code></strong>, khÃ´ng giá»‘ng nhÆ° cÃ¡c ngÃ´n ngá»¯ ká»‹ch báº£n khÃ¡c nhÆ° <strong><code class="highlighter-rouge">Lua</code></strong>, khÃ´ng cho phÃ©p mÃ£ náº±m ngoÃ i cÃ¡c hÃ m. Sau khi Ä‘á»c Ä‘iá»u Ä‘Ã³, cÃ³ láº½ báº¡n chá»‰ muá»‘n xÃ¡c Ä‘á»‹nh má»™t sá»‘ chá»©c nÄƒng, Ä‘áº·t tÃªn chÃ­nh lÃ  cÃ³ thá»ƒ, biÃªn dá»‹ch vÃ  táº£i má»™t plugin vÃ  tháº¥y ráº±ng mÃ£ cá»§a báº¡n khÃ´ng bao giá» Ä‘Æ°á»£c gá»i.</p>

<p>VÃ¬ váº­y, lÃ m tháº¿ nÃ o Ä‘á»ƒ chÃºng ta gá»i <strong><code class="highlighter-rouge">SourceMod</code></strong> mÃ£ cá»§a chÃºng ta? VÃ¬ lÃ½ do chÃ­nh xÃ¡c nÃ y, chÃºng ta pháº£i chuyá»ƒn tiáº¿p. Chuyá»ƒn tiáº¿p lÃ  cÃ¡c nguyÃªn máº«u hÃ m do má»™t bÃªn khai bÃ¡o cÃ³ thá»ƒ Ä‘Æ°á»£c bÃªn khÃ¡c triá»ƒn khai dÆ°á»›i dáº¡ng gá»i láº¡i. Khi bÃªn thá»© nháº¥t báº¯t Ä‘áº§u cuá»™c gá»i chuyá»ƒn tiáº¿p, táº¥t cáº£ cÃ¡c bÃªn cÃ³ cuá»™c gá»i láº¡i phÃ¹ há»£p sáº½ nháº­n cuá»™c gá»i.</p>

<p><strong><code class="highlighter-rouge">SourceMod</code></strong> khai bÃ¡o ráº¥t nhiá»u chuyá»ƒn tiáº¿p thÃº vá»‹ mÃ  chÃºng ta cÃ³ thá»ƒ triá»ƒn khai. NhÆ° báº¡n cÃ³ thá»ƒ tháº¥y, chuyá»ƒn tiáº¿p lÃ  cÃ¡ch duy nháº¥t Ä‘á»ƒ mÃ£ cá»§a chÃºng ta Ä‘Æ°á»£c thá»±c thi, hÃ£y ghi nhá»› Ä‘iá»u Ä‘Ã³. VÃ¬ váº­y, hÃ£y thá»±c hiá»‡n <strong><code class="highlighter-rouge">OnPluginStart</code></strong> vá» phÃ­a trÆ°á»›c. NhÆ° báº¡n cÃ³ thá»ƒ Ä‘oÃ¡n, nÃ³ Ä‘Æ°á»£c gá»i khi plugin cá»§a chÃºng ta khá»Ÿi Ä‘á»™ng. Äá»ƒ lÃ m Ä‘iá»u Ä‘Ã³, chÃºng ta sáº½ pháº£i tra cá»©u khai bÃ¡o cá»§a <strong><code class="highlighter-rouge">OnPluginStart</code></strong>. NÃ³ Ä‘Æ°á»£c khai bÃ¡o bÃªn trong <strong><code class="highlighter-rouge">sourcemod.inc</code></strong>, má»™t tá»‡p chÃºng ta Ä‘Ã£ quen thuá»™c.</p>

<p>Dáº¥u ngoáº·c Ä‘Æ¡n trá»‘ng cho chÃºng ta biáº¿t ráº±ng khÃ´ng cÃ³ Ä‘á»‘i sá»‘ nÃ o Ä‘Æ°á»£c chuyá»ƒn vÃ o bÃªn trong <strong><code class="highlighter-rouge">forward</code></strong> nÃ y, tÃ i liá»‡u bÃªn trong <strong><code class="highlighter-rouge">@noreturn</code></strong> cho chÃºng ta biáº¿t ráº±ng chÃºng ta khÃ´ng pháº£i tráº£ vá» báº¥t cá»© thá»© gÃ¬, khÃ¡ Ä‘Æ¡n giáº£n vá» phÃ­a trÆ°á»›c.</p>

<p>Váº­y lÃ m tháº¿ nÃ o Ä‘á»ƒ viáº¿t má»™t cuá»™c gá»i láº¡i chÃ­nh xÃ¡c cho nÃ³? Thá»© nháº¥t, lá»‡nh gá»i láº¡i cá»§a chÃºng ta pháº£i cÃ³ cÃ¹ng tÃªn, vÃ¬ váº­y Ä‘Ã³ lÃ  <strong><code class="highlighter-rouge">OnPluginStart</code></strong>, thá»© hai, lá»‡nh gá»i láº¡i cá»§a chÃºng ta pháº£i cÃ³ cÃ¹ng sá»‘ lÆ°á»£ng Ä‘á»‘i sá»‘, khÃ´ng cÃ³ Ä‘á»‘i sá»‘ nÃ o trong trÆ°á»ng há»£p nÃ y vÃ  cuá»‘i cÃ¹ng, <strong><code class="highlighter-rouge">SourceMod</code></strong> cáº§n cÃ³ thá»ƒ gá»i lá»‡nh gá»i láº¡i cá»§a chÃºng ta nÃªn nÃ³ cáº§n Ä‘Æ°á»£c cÃ´ng khai. VÃ¬ váº­y, viá»‡c triá»ƒn khai trÃ´ng nhÆ° tháº¿ nÃ y:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
  <span class="cm">/**
        * ÄÆ°á»£c gá»i khi plugin Ä‘Æ°á»£c khá»Ÿi táº¡o hoÃ n toÃ n vÃ  táº¥t cáº£ cÃ¡c tham chiáº¿u bÃªn ngoÃ i Ä‘Ã£ biáº¿t
        * Ä‘Æ°á»£c giáº£i quyáº¿t. Äiá»u nÃ y chá»‰ Ä‘Æ°á»£c gá»i má»™t láº§n trong vÃ²ng Ä‘á»i cá»§a plugin vÃ 
        * Ä‘Æ°á»£c ghÃ©p ná»‘i vá»›i OnPluginEnd().
        *
        * Náº¿u báº¥t ká»³ lá»—i thá»i gian cháº¡y nÃ o Ä‘Æ°á»£c Ä‘Æ°a ra trong quÃ¡ trÃ¬nh gá»i láº¡i nÃ y, plugin sáº½ Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u
        * nhÆ° khÃ´ng thÃ nh cÃ´ng.
        *
        * KhÃ´ng cáº§n thiáº¿t pháº£i Ä‘Ã³ng báº¥t ká»³ handles hoáº·c loáº¡i bá» hooks trong function nÃ y.  
        * SourceMod Ä‘áº£m báº£o ráº±ng plugin táº¯t tá»± Ä‘á»™ng vÃ  phÃ¡t hÃ nh chÃ­nh xÃ¡c 
        * táº¥t cáº£ tÃ i nguyÃªn.
        *
        * @noreturn
        */</span>

    <span class="n">forward</span> <span class="kt">void</span> <span class="nf">OnPluginStart</span><span class="o">();</span>
    <span class="o">{</span>
        
    <span class="o">}</span>

</code></pre></div></div>
<p>BÃ¢y giá» chÃºng ta cÃ³ thá»ƒ viáº¿t mÃ£ bÃªn trong dáº¥u ngoáº·c nhá»n vÃ  nÃ³ sáº½ Ä‘Æ°á»£c thá»±c thi khi plugin cá»§a chÃºng ta khá»Ÿi Ä‘á»™ng. HÃ£y xuáº¥t <strong><code class="highlighter-rouge">"Hello world!"</code></strong> Ä‘áº¿n báº£ng Ä‘iá»u khiá»ƒn mÃ¡y chá»§.</p>

<p>Äá»ƒ lÃ m Ä‘iá»u Ä‘Ã³, chÃºng ta sáº½ sá»­ dá»¥ng chá»©c nÄƒng <strong><code class="highlighter-rouge">PrintToServer</code></strong>. NÃ³ Ä‘Æ°á»£c khai bÃ¡o bÃªn trong <strong><code class="highlighter-rouge">console.inc</code></strong>, tuy nhiÃªn, chÃºng ta khÃ´ng cáº§n pháº£i bao gá»“m <strong><code class="highlighter-rouge">console.inc</code></strong> theo cÃ¡ch thá»§ cÃ´ng vÃ¬ nÃ³ Ä‘Æ°á»£c tá»± Ä‘á»™ng Ä‘Æ°a vÃ o nhÆ° má»™t pháº§n cá»§a <strong><code class="highlighter-rouge">sourcemod.inc</code></strong>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="cm">/**
        * Print message Ä‘áº¿n báº£ng Ä‘iá»u khiá»ƒn mÃ¡y chá»§.
        *
        * @param format		Quy táº¯c Ä‘á»‹nh dáº¡ng.
        * @param ...			Sá»‘ lÆ°á»£ng tham sá»‘ Ä‘á»‹nh dáº¡ng thay Ä‘á»•i.
        * @noreturn
        */</span>
    <span class="kd">native</span> <span class="kt">int</span> <span class="nf">PrintToServer</span><span class="o">(</span><span class="kd">const</span> <span class="kt">char</span><span class="o">[]</span> <span class="n">format</span><span class="o">,</span> <span class="n">any</span> <span class="o">...);</span>

</code></pre></div></div>

<p>NhÆ° báº¡n cÃ³ thá»ƒ tháº¥y, Ä‘Ã¢y lÃ  má»™t hÃ m gá»‘c. NÃ³ Ä‘Æ°á»£c thá»±c hiá»‡n bÃªn trong lÃµi SM. ÄÃ¡nh giÃ¡ báº±ng cÃ¡c Ä‘á»‘i sá»‘ cá»§a nÃ³, chÃºng ta cÃ³ thá»ƒ tháº¥y ráº±ng nÃ³ lÃ  má»™t hÃ m lá»›p Ä‘á»‹nh dáº¡ng. Tuy nhiÃªn, hiá»‡n táº¡i chÃºng ta khÃ´ng cáº§n báº¥t ká»³ Ä‘á»‹nh dáº¡ng nÃ o, vÃ¬ váº­y chÃºng ta chá»‰ cáº§n chuyá»ƒn chuá»—i  <strong><code class="highlighter-rouge">"Hello world!"</code></strong> nhÆ° lÃ  má»™t Ä‘á»‘i sá»‘ duy nháº¥t:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">OnPluginStart</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="nc">PrintToServer</span><span class="o">(</span><span class="s">"Hello world!"</span><span class="o">);</span>
    <span class="o">}</span>

</code></pre></div></div>

<p>Code Ä‘áº§y Ä‘á»§ trong má»™t plugin chÃºng ta vá»«a viáº¿t cÃ³ dáº¡ng nhÆ° sau:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="err">#</span><span class="n">include</span> <span class="o">&lt;</span><span class="n">sourcemod</span><span class="o">&gt;</span>
    
    <span class="kd">public</span> <span class="nc">Plugin</span> <span class="n">myinfo</span> <span class="o">=</span>
    <span class="o">{</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"My First Plugin"</span><span class="o">,</span>
        <span class="n">author</span> <span class="o">=</span> <span class="s">"Me"</span><span class="o">,</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s">"My first plugin ever"</span><span class="o">,</span>
        <span class="n">version</span> <span class="o">=</span> <span class="s">"1.0"</span><span class="o">,</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s">"http://www.sourcemod.net/"</span>
    <span class="o">};</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">OnPluginStart</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="nc">PrintToServer</span><span class="o">(</span><span class="s">"Hello world!"</span><span class="o">);</span>
    <span class="o">}</span>

</code></pre></div></div>

<p>BiÃªn dá»‹ch vÃ  up plugin cá»§a báº¡n lÃªn mÃ¡y chá»§ cá»§a báº¡n vÃ  tá»± mÃ¬nh tháº¥y ráº±ng thÃ´ng bÃ¡o Ä‘Æ°á»£c hiá»ƒn thá»‹ trong báº£ng Ä‘iá»u khiá»ƒn mÃ¡y chá»§.</p>

<h2 id="includes">Includes</h2>
<hr />

<p>Pawn yÃªu cáº§u cÃ¡c tá»‡p bao gá»“m, giá»‘ng nhÆ° C yÃªu cáº§u tá»‡p tiÃªu Ä‘á». Bao gá»“m cÃ¡c tá»‡p liá»‡t kÃª táº¥t cáº£ cÃ¡c cáº¥u trÃºc, chá»©c nÄƒng, lá»‡nh gá»i láº¡i vÃ  tháº» cÃ³ sáºµn. CÃ³ ba loáº¡i tá»‡p bao gá»“m:</p>

<p>â€¢ Core - <strong><code class="highlighter-rouge">sourcemod.inc</code></strong> vÃ  báº¥t cá»© thá»© gÃ¬ nÃ³ bao gá»“m. Táº¥t cáº£ Ä‘á»u Ä‘Æ°á»£c cung cáº¥p bá»Ÿi SourceModâ€™s Core.<br />
 â€¢ Extension - thÃªm pháº§n phá»¥ thuá»™c vÃ o má»™t pháº§n má»Ÿ rá»™ng nháº¥t Ä‘á»‹nh.<br />
 â€¢ Plugin - thÃªm phá»¥ thuá»™c vÃ o má»™t plugin nháº¥t Ä‘á»‹nh.<br /></p>

<p>Bao gá»“m cÃ¡c tá»‡p Ä‘Æ°á»£c táº£i báº±ng cÃ¡ch sá»­ dá»¥ng chá»‰ thá»‹ trÃ¬nh biÃªn dá»‹ch <strong><code class="highlighter-rouge">#include</code></strong>.</p>

<h2 id="commands">Commands</h2>
<hr />

<p>VÃ­ dá»¥ Ä‘áº§u tiÃªn cá»§a chÃºng ta sáº½ viáº¿t má»™t lá»‡nh Admin Ä‘Æ¡n giáº£n Ä‘á»ƒ Slap má»™t Player. ChÃºng ta sáº½ tiáº¿p tá»¥c má»Ÿ rá»™ng vÃ­ dá»¥ nÃ y vá»›i nhiá»u tÃ­nh nÄƒng hÆ¡n cho Ä‘áº¿n khi chÃºng ta cÃ³ káº¿t quáº£ cuá»‘i cÃ¹ng, hoÃ n chá»‰nh.</p>

<h2 id="khai-bÃ¡o">Khai bÃ¡o</h2>
<hr />

<p>TrÆ°á»›c tiÃªn, hÃ£y xem má»™t lá»‡nh Admim yÃªu cáº§u nhá»¯ng gÃ¬. CÃ¡c lá»‡nh admin Ä‘Æ°á»£c register báº±ng cÃ¡ch khai bÃ¡o hÃ m<strong><code class="highlighter-rouge">RegAdminCmd</code></strong>. ChÃºng yÃªu cáº§u <strong>â€œchuá»—i lá»‡nh thá»±c thiâ€</strong>, <strong>hÃ m Ä‘Æ°á»£c gá»i</strong>, <strong>cá» admin (flag)</strong>.</p>

<p>Khai bÃ¡o function, cÃ¡ch thá»©c sá»­ dá»¥ng <a href="https://sm.alliedmods.net/new-api/console/ConCmd"><strong>táº¡i Ä‘Ã¢y</strong></a></p>

<p>CÃ¡ch viáº¿t:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">OnPluginStart</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="nc">RegAdminCmd</span><span class="o">(</span><span class="s">"sm_myslap"</span><span class="o">,</span> <span class="n">Command_MySlap</span><span class="o">,</span> <span class="no">ADMFLAG_SLAY</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">Action</span> <span class="nf">Command_MySlap</span><span class="o">(</span><span class="kt">int</span> <span class="n">client</span><span class="o">,</span> <span class="kt">int</span> <span class="n">args</span><span class="o">)</span>
    <span class="o">{</span>
        
    <span class="o">}</span>

</code></pre></div></div>

<p>BÃ¢y giá» chÃºng tata Ä‘Ã£ thá»±c hiá»‡n thÃ nh cÃ´ng má»™t lá»‡nh - máº·c dÃ¹ nÃ³ chÆ°a thá»±c hiá»‡n Ä‘Æ°á»£c gÃ¬. Trong thá»±c táº¿, nÃ³ sáº½ bÃ¡o â€œLá»‡nh khÃ´ng xÃ¡c Ä‘á»‹nhâ€ náº¿u báº¡n sá»­ dá»¥ng nÃ³! Äiá»u nÃ y lÃ  do báº¡n khÃ´ng tráº£ vá» Plugin_Handled trong cuá»™c gá»i láº¡i cá»§a báº¡n.</p>

<p>VÃ¬ báº¡n chÆ°a Ä‘Äƒng kÃ½ nÃªn <strong><code class="highlighter-rouge">SourceMod</code></strong> tin ráº±ng báº¡n khÃ´ng muá»‘n <strong><code class="highlighter-rouge">Source Engine</code></strong> biáº¿t lá»‡nh Ä‘Ã£ Ä‘Æ°á»£c Ä‘Äƒng kÃ½ vÃ  nÃ³ xá»­ lÃ½ nhÆ° váº­y. Do <strong><code class="highlighter-rouge">SourceMod</code></strong> mong Ä‘á»£i <strong><code class="highlighter-rouge">function</code></strong> cá»§a báº¡n <strong><code class="highlighter-rouge">return Plugin_Handled</code></strong> lÃ  do tháº» Action báº¡n Ä‘áº·t trong nguyÃªn máº«u cá»§a hÃ m. Tháº» HÃ nh Ä‘á»™ng chá»‰ Ä‘á»‹nh ráº±ng <strong><code class="highlighter-rouge">Command_MySlap</code></strong> pháº£i tráº£ vá» má»™t trong bá»‘n Ä‘iá»u. Xem liá»‡t kÃª <a href="https://sm.alliedmods.net/new-api/core/Action"><strong>Action</strong></a> trong <strong><code class="highlighter-rouge">API sourcemod</code></strong> Ä‘á»ƒ tÃ¬m hiá»ƒu thÃªm vá» cÃ¡c loáº¡i tráº£ láº¡i nÃ y vÃ  khi nÃ o sá»­ dá»¥ng chÃºng.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="kd">public</span> <span class="nc">Action</span> <span class="nf">Command_MySlap</span><span class="o">(</span><span class="kt">int</span> <span class="n">client</span><span class="o">,</span> <span class="kt">int</span> <span class="n">args</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="k">return</span> <span class="n">Plugin_Handled</span><span class="o">;</span>
    <span class="o">}</span>

</code></pre></div></div>

<p>BÃ¢y giá» lá»‡nh sáº½ khÃ´ng bÃ¡o lá»—i, nhÆ°ng nÃ³ váº«n khÃ´ng lÃ m gÃ¬ cáº£. Äiá»u nÃ y lÃ  do viá»‡c tráº£ vá» â€œPlugin_Handledâ€ trong lá»‡nh gá»i láº¡i lá»‡nh sáº½ ngÄƒn engine xá»­ lÃ½ lá»‡nh. Äá»™ng cÆ¡ tháº­m chÃ­ sáº½ khÃ´ng bao giá» tháº¥y ráº±ng lá»‡nh Ä‘Ã£ Ä‘Æ°á»£c cháº¡y. ÄÃ¢y lÃ  nhá»¯ng gÃ¬ báº¡n sáº½ muá»‘n lÃ m náº¿u báº¡n Ä‘ang Ä‘Äƒng kÃ½ má»™t lá»‡nh hoÃ n toÃ n má»›i thÃ´ng qua <strong><code class="highlighter-rouge">SourceMod</code></strong>.</p>

<h2 id="thá»±c-thi">Thá»±c thi</h2>
<hr />

<p>HÃ£y quyáº¿t Ä‘á»‹nh lá»‡nh sáº½ nhÆ° tháº¿ nÃ o. HÃ£y Ä‘á»ƒ nÃ³ hoáº¡t Ä‘á»™ng giá»‘ng nhÆ° lá»‡nh sm_slap máº·c Ä‘á»‹nh:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="n">sm_myslap</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">|</span><span class="err">#</span><span class="n">userid</span><span class="o">&gt;</span> <span class="o">[</span><span class="n">damage</span><span class="o">]</span>

</code></pre></div></div>

<p>Äá»ƒ thá»±c hiá»‡n Ä‘iá»u nÃ y, chÃºng ta sáº½ cáº§n má»™t vÃ i bÆ°á»›c:</p>

<p>â€¢ Get the input from the console. For this we use <a href="https://sm.alliedmods.net/new-api/console/GetCmdArg"><strong>GetCmdArg()</strong></a>.<br />
 â€¢ Find a matching player. For this we use <a href="https://sm.alliedmods.net/new-api/helpers/FindTarget"><strong>FindTarget()</strong></a>.<br />
 â€¢ Slap them. For this we use <a href="https://sm.alliedmods.net/new-api/sdktools_functions/SlapPlayer"><strong>SlapPlayer()</strong></a>, which requires including sdktools, an extension bundled with SourceMod.<br />
 â€¢ Respond to the admin. For this we use <a href="https://sm.alliedmods.net/new-api/console/ReplyToCommand"><strong>ReplyToCommand()</strong></a>.<br /></p>

<p>VÃ­ dá»¥ máº«u Ä‘áº§y Ä‘á»§:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="err">#</span><span class="n">include</span> <span class="o">&lt;</span><span class="n">sourcemod</span><span class="o">&gt;</span>
    <span class="err">#</span><span class="n">include</span> <span class="o">&lt;</span><span class="n">sdktools</span><span class="o">&gt;</span>
    
    <span class="kd">public</span> <span class="nc">Plugin</span> <span class="n">myinfo</span> <span class="o">=</span>
    <span class="o">{</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"My First Plugin"</span><span class="o">,</span>
        <span class="n">author</span> <span class="o">=</span> <span class="s">"Me"</span><span class="o">,</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s">"My first plugin ever"</span><span class="o">,</span>
        <span class="n">version</span> <span class="o">=</span> <span class="s">"1.0.0.0"</span><span class="o">,</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s">"http://www.sourcemod.net/"</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">OnPluginStart</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="nc">RegAdminCmd</span><span class="o">(</span><span class="s">"sm_myslap"</span><span class="o">,</span> <span class="n">Command_MySlap</span><span class="o">,</span> <span class="no">ADMFLAG_SLAY</span><span class="o">);</span>

        <span class="c1">// Báº¯t buá»™c Ä‘á»‘i vá»›i cÃ¢u tráº£ lá»i khÃ´ng thÃ nh cÃ´ng cá»§a FindTarget</span>
        <span class="nc">LoadTranslations</span><span class="o">(</span><span class="s">"common.phrases.txt"</span><span class="o">);</span> 
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">Action</span> <span class="nf">Command_MySlap</span><span class="o">(</span><span class="kt">int</span> <span class="n">client</span><span class="o">,</span> <span class="kt">int</span> <span class="n">args</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="kt">char</span> <span class="n">arg1</span><span class="o">[</span><span class="mi">32</span><span class="o">],</span> <span class="n">arg2</span><span class="o">[</span><span class="mi">32</span><span class="o">];</span>
    
        <span class="cm">/* Theo máº·c Ä‘á»‹nh, chÃºng ta Ä‘áº·t damage = 0 */</span>
        <span class="kt">int</span> <span class="n">damage</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    
        <span class="cm">/* Láº¥y Ä‘á»‘i sá»‘ Ä‘áº§u tiÃªn */</span>
        <span class="nc">GetCmdArg</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">arg1</span><span class="o">,</span> <span class="n">sizeof</span><span class="o">(</span><span class="n">arg1</span><span class="o">));</span>
    
        <span class="cm">/* Náº¿u cÃ³ tá»« 2 Ä‘á»‘i sá»‘ trá»Ÿ lÃªn, chÃºng ta Ä‘áº·t damage cho
                    * nhá»¯ng gÃ¬ ngÆ°á»i dÃ¹ng chá»‰ Ä‘á»‹nh. Náº¿u má»™t thiá»‡t háº¡i khÃ´ng Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh
                    * sau Ä‘Ã³ nÃ³ sáº½ á»Ÿ má»©c 0. 
                    */</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">args</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="nc">GetCmdArg</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">arg2</span><span class="o">,</span> <span class="n">sizeof</span><span class="o">(</span><span class="n">arg2</span><span class="o">));</span>
            <span class="n">damage</span> <span class="o">=</span> <span class="nc">StringToInt</span><span class="o">(</span><span class="n">arg2</span><span class="o">);</span>
        <span class="o">}</span>
    
        <span class="cm">/* Try and find a matching player */</span>
        <span class="kt">int</span> <span class="n">target</span> <span class="o">=</span> <span class="nc">FindTarget</span><span class="o">(</span><span class="n">client</span><span class="o">,</span> <span class="n">arg1</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">target</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="cm">/* FindTarget() tá»± Ä‘á»™ng tráº£ lá»i vá»›i
                                * lÃ½ do tháº¥t báº¡i vÃ  tráº£ vá» -1 nÃªn chÃºng ta biáº¿t 0
                                * tiáº¿p tá»¥c...
                                */</span>
            <span class="k">return</span> <span class="n">Plugin_Handled</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="nc">SlapPlayer</span><span class="o">(</span><span class="n">target</span><span class="o">,</span> <span class="n">damage</span><span class="o">);</span>
        <span class="nc">ReplyToCommand</span><span class="o">(</span><span class="n">client</span><span class="o">,</span> <span class="s">"[SM] You slapped %N for %d damage!"</span><span class="o">,</span> <span class="n">target</span><span class="o">,</span> <span class="n">damage</span><span class="o">);</span>
    
        <span class="k">return</span> <span class="n">Plugin_Handled</span><span class="o">;</span>
    <span class="o">}</span>

</code></pre></div></div>

<p>Äá»ƒ biáº¿t thÃªm thÃ´ng tin vá» %N vÃ  %d lÃ  gÃ¬, hÃ£y xem <a href="https://wiki.alliedmods.net/Format_Class_Functions_(SourceMod_Scripting)"><strong>function</strong></a> lá»›p Ä‘á»‹nh dáº¡ng. LÆ°u Ã½ ráº±ng báº¡n khÃ´ng bao giá» cáº§n há»§y Ä‘Äƒng kÃ½ hoáº·c xÃ³a lá»‡nh Admin cá»§a mÃ¬nh. Khi má»™t plugin Ä‘Æ°á»£c táº£i xuá»‘ng, SourceMod sáº½ dá»n dáº¹p nÃ³ cho báº¡n.</p>

<h2 id="convars">ConVars</h2>
<hr />

<p>TÃ­nh nÄƒng tiá»‡n dá»¥ng cá»§a <strong><code class="highlighter-rouge">ConVars</code></strong> lÃ  chÃºng dá»… dÃ ng cáº¥u hÃ¬nh cho ngÆ°á»i dÃ¹ng. ChÃºng cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘áº·t trong báº¥t <strong><code class="highlighter-rouge">file .cfg</code></strong> nÃ o, cháº³ng háº¡n nhÆ° <strong><code class="highlighter-rouge">server.cfg</code></strong> hoáº·c <strong><code class="highlighter-rouge">sourcemod.cfg</code></strong>. Äá»ƒ lÃ m cho viá»‡c nÃ y dá»… dÃ ng hÆ¡n, SourceMod cÃ³ chá»©c nÄƒng <a href="https://sm.alliedmods.net/new-api/sourcemod/AutoExecConfig"><strong>AutoExecConfig()</strong></a>. Chá»©c nÄƒng nÃ y sáº½ tá»± Ä‘á»™ng táº¡o má»™t <strong><code class="highlighter-rouge">file .cfg</code></strong> máº·c Ä‘á»‹nh chá»©a táº¥t cáº£ cÃ¡c <strong><code class="highlighter-rouge">cvars</code></strong> cá»§a báº¡n, Ä‘Æ°á»£c chÃº thÃ­ch báº±ng nháº­n xÃ©t, cho ngÆ°á»i dÃ¹ng. Ráº¥t khuyáº¿n khÃ­ch báº¡n gá»i nÃ³ náº¿u báº¡n cÃ³ <strong><code class="highlighter-rouge">ConVars</code></strong> cÃ³ thá»ƒ tÃ¹y chá»‰nh.</p>

<p>HÃ£y má»Ÿ rá»™ng vÃ­ dá»¥ cá»§a báº¡n tá»« trÆ°á»›c vá»›i má»™t ConVar má»›i. ConVar cá»§a chÃºng tÃ´i sáº½ lÃ  <strong><code class="highlighter-rouge">g_cvarMySlapDamage</code></strong> vÃ  sáº½ chá»‰ Ä‘á»‹nh <strong><code class="highlighter-rouge">damage</code></strong> máº·c Ä‘á»‹nh mÃ  ai Ä‘Ã³ bá»‹ tÃ¡t náº¿u khÃ´ng cÃ³ thiá»‡t háº¡i nÃ o Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="nc">ConVar</span> <span class="n">g_cvarMySlapDamage</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">OnPluginStart</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="nc">RegAdminCmd</span><span class="o">(</span><span class="s">"sm_myslap"</span><span class="o">,</span> <span class="n">Command_MySlap</span><span class="o">,</span> <span class="no">ADMFLAG_SLAY</span><span class="o">);</span>
    
        <span class="n">g_cvarMySlapDamage</span> <span class="o">=</span> <span class="nc">CreateConVar</span><span class="o">(</span><span class="s">"sm_myslap_damage"</span><span class="o">,</span> <span class="s">"5"</span><span class="o">,</span> <span class="s">"Default slap damage"</span><span class="o">);</span>
        <span class="nc">AutoExecConfig</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="s">"plugin_myslap"</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">Action</span> <span class="nf">Command_MySlap</span><span class="o">(</span><span class="kt">int</span> <span class="n">client</span><span class="o">,</span> <span class="kt">int</span> <span class="n">args</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="kt">char</span> <span class="n">arg1</span><span class="o">[</span><span class="mi">32</span><span class="o">],</span> <span class="n">arg2</span><span class="o">[</span><span class="mi">32</span><span class="o">];</span>
        <span class="kt">int</span> <span class="n">damage</span> <span class="o">=</span> <span class="n">g_cvarMySlapDamage</span><span class="o">.</span><span class="na">IntValue</span><span class="o">;</span>
    
        <span class="cm">/* Pháº§n cÃ²n láº¡i váº«n khÃ´ng thay Ä‘á»•i! */</span>
    

</code></pre></div></div>

<h2 id="hiá»ƒn-thá»‹-hoáº¡t-Ä‘á»™ng-ghi-nháº­t-kÃ½">Hiá»ƒn thá»‹ Hoáº¡t Ä‘á»™ng, Ghi nháº­t kÃ½</h2>
<hr />

<p>Háº§u háº¿t táº¥t cáº£ cÃ¡c lá»‡nh Admin sáº½ ghi láº¡i hoáº¡t Ä‘á»™ng cá»§a chÃºng vÃ  má»™t sá»‘ lá»‡nh Admin sáº½ hiá»ƒn thá»‹ hoáº¡t Ä‘á»™ng cá»§a chÃºng cho cÃ¡c Client trong trÃ² chÆ¡i. Äiá»u nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c thá»±c hiá»‡n thÃ´ng qua cÃ¡c function <a href="https://sm.alliedmods.net/new-api/logging/LogAction"><strong>LogAction()</strong></a> vÃ  <a href="https://sm.alliedmods.net/new-api/console/ShowActivity2"><strong>ShowActivity2()</strong></a>. Chá»©c nÄƒng chÃ­nh xÃ¡c cá»§a <strong><code class="highlighter-rouge">ShowActivity2()</code></strong> Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi cvar <strong><code class="highlighter-rouge">sm_show_activity</code></strong>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
        <span class="nc">SlapPlayer</span><span class="o">(</span><span class="n">target</span><span class="o">,</span> <span class="n">damage</span><span class="o">);</span>
    
        <span class="kt">char</span> <span class="n">name</span><span class="o">[</span><span class="no">MAX_NAME_LENGTH</span><span class="o">];</span>
    
        <span class="nc">GetClientName</span><span class="o">(</span><span class="n">target</span><span class="o">,</span> <span class="n">name</span><span class="o">,</span> <span class="n">sizeof</span><span class="o">(</span><span class="n">name</span><span class="o">));</span>
    
        <span class="nc">ShowActivity2</span><span class="o">(</span><span class="n">client</span><span class="o">,</span> <span class="s">"[SM] "</span><span class="o">,</span> <span class="s">"Slapped %s for %d damage!"</span><span class="o">,</span> <span class="n">name</span><span class="o">,</span> <span class="n">damage</span><span class="o">);</span>
        <span class="nc">LogAction</span><span class="o">(</span><span class="n">client</span><span class="o">,</span> <span class="n">target</span><span class="o">,</span> <span class="s">"\"%L\" slapped \"%L\" (damage %d)"</span><span class="o">,</span> <span class="n">client</span><span class="o">,</span> <span class="n">target</span><span class="o">,</span> <span class="n">damage</span><span class="o">);</span>
    
        <span class="k">return</span> <span class="n">Plugin_Handled</span><span class="o">;</span>
    <span class="o">}</span>

</code></pre></div></div>

<h2 id="multiple-targets">Multiple Targets</h2>
<hr />

<p>Äá»ƒ hoÃ n thÃ nh Ä‘áº§y Ä‘á»§ pháº§n thá»±c thi Slap cá»§a chÃºng ta, hÃ£y lÃ m cho nÃ³ há»— trá»£ <strong><code class="highlighter-rouge">multiple targets</code></strong>. <a href="https://wiki.alliedmods.net/Admin_Commands_(SourceMod)#How_to_Target"><strong>targeting sytem</strong></a> cá»§a SourceMod khÃ¡ tiÃªn tiáº¿n, vÃ¬ váº­y viá»‡c sá»­ dá»¥ng nÃ³ lÃºc Ä‘áº§u cÃ³ váº» phá»©c táº¡p.</p>

<p>HÃ m chÃºng tÃ´i sá»­ dá»¥ng lÃ  <a href="https://sm.alliedmods.net/new-api/commandfilters/ProcessTargetString"><strong>ProcessTargetString()</strong></a>. NÃ³ nháº­n Ä‘áº§u vÃ o tá»« báº£ng Ä‘iá»u khiá»ƒn vÃ  tráº£ vá» danh sÃ¡ch cÃ¡c mÃ¡y khÃ¡ch phÃ¹ há»£p. NÃ³ cÅ©ng tráº£ vá» má»™t danh tá»« sáº½ xÃ¡c Ä‘á»‹nh má»™t khÃ¡ch hÃ ng duy nháº¥t hoáº·c mÃ´ táº£ má»™t danh sÃ¡ch cÃ¡c khÃ¡ch hÃ ng. Ã tÆ°á»Ÿng lÃ  sau Ä‘Ã³ má»—i Client sáº½ Ä‘Æ°á»£c xá»­ lÃ½, nhÆ°ng hoáº¡t Ä‘á»™ng hiá»ƒn thá»‹ cho táº¥t cáº£ ngÆ°á»i chÆ¡i chá»‰ Ä‘Æ°á»£c xá»­ lÃ½ má»™t láº§n. Äiá»u nÃ y lÃ m <strong><code class="highlighter-rouge">spam message</code></strong> trÃªn mÃ n hÃ¬nh.</p>

<p>PhÆ°Æ¡ng phÃ¡p xá»­ lÃ½ Ä‘Ã­ch nÃ y Ä‘Æ°á»£c sá»­ dá»¥ng cho háº§u háº¿t má»i lá»‡nh Admin trong SourceMod vÃ  trÃªn thá»±c táº¿, <strong><code class="highlighter-rouge">FindTarget()</code></strong> chá»‰ lÃ  má»™t phiÃªn báº£n Ä‘Æ¡n giáº£n hÃ³a.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="err">#</span><span class="n">include</span> <span class="o">&lt;</span><span class="n">sourcemod</span><span class="o">&gt;</span>
    <span class="err">#</span><span class="n">include</span> <span class="o">&lt;</span><span class="n">sdktools</span><span class="o">&gt;</span>
    
    <span class="nc">ConVar</span> <span class="n">g_cvarMySlapDamage</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nc">Plugin</span> <span class="n">myinfo</span> <span class="o">=</span>
    <span class="o">{</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s">"My First Plugin"</span><span class="o">,</span>
        <span class="n">author</span> <span class="o">=</span> <span class="s">"Me"</span><span class="o">,</span>
        <span class="n">description</span> <span class="o">=</span> <span class="s">"My first plugin ever"</span><span class="o">,</span>
        <span class="n">version</span> <span class="o">=</span> <span class="s">"1.0.0.0"</span><span class="o">,</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s">"http://www.sourcemod.net/"</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">OnPluginStart</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="nc">RegAdminCmd</span><span class="o">(</span><span class="s">"sm_myslap"</span><span class="o">,</span> <span class="n">Command_MySlap</span><span class="o">,</span> <span class="no">ADMFLAG_SLAY</span><span class="o">);</span>
        <span class="nc">LoadTranslations</span><span class="o">(</span><span class="s">"common.phrases.txt"</span><span class="o">);</span>
    
        <span class="n">g_cvarMySlapDamage</span> <span class="o">=</span> <span class="nc">CreateConVar</span><span class="o">(</span><span class="s">"sm_myslap_damage"</span><span class="o">,</span> <span class="s">"5"</span><span class="o">,</span> <span class="s">"Default slap damage"</span><span class="o">);</span>
        <span class="nc">AutoExecConfig</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span> <span class="s">"plugin_myslap"</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">Action</span> <span class="nf">Command_MySlap</span><span class="o">(</span><span class="kt">int</span> <span class="n">client</span><span class="o">,</span> <span class="kt">int</span> <span class="n">args</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="kt">char</span> <span class="n">arg1</span><span class="o">[</span><span class="mi">32</span><span class="o">],</span> <span class="n">arg2</span><span class="o">[</span><span class="mi">32</span><span class="o">];</span>
        <span class="kt">int</span> <span class="n">damage</span> <span class="o">=</span> <span class="n">g_cvarMySlapDamage</span><span class="o">.</span><span class="na">IntValue</span><span class="o">;</span>
    
        <span class="cm">/* Get the first argument */</span>
        <span class="nc">GetCmdArg</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">arg1</span><span class="o">,</span> <span class="n">sizeof</span><span class="o">(</span><span class="n">arg1</span><span class="o">));</span>
    
        <span class="cm">/*Náº¿u cÃ³ 2 hoáº·c nhiá»u Ä‘á»‘i sá»‘ vÃ  Ä‘á»‘i sá»‘ thá»© hai tÃ¬m náº¡p
         * thÃ nh cÃ´ng, hÃ£y chuyá»ƒn nÃ³ thÃ nh má»™t sá»‘ nguyÃªn.
         */</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">args</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="nc">GetCmdArg</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">arg2</span><span class="o">,</span> <span class="n">sizeof</span><span class="o">(</span><span class="n">arg2</span><span class="o">)))</span>
        <span class="o">{</span>
            <span class="n">damage</span> <span class="o">=</span> <span class="nc">StringToInt</span><span class="o">(</span><span class="n">arg2</span><span class="o">);</span>
        <span class="o">}</span>
            
        <span class="cm">/**
                    * target_name - lÆ°u trá»¯ tÃªn vÃ  xÃ¡c Ä‘á»‹nh cÃ¡c target
                    * target_list - máº£ng Ä‘á»ƒ lÆ°u trá»¯ danh sÃ¡ch Client
                    * target_count - biáº¿n Ä‘á»ƒ lÆ°u trá»¯ sá»‘ lÆ°á»£ng Client
                    * tn_is_ml - lÆ°u trá»¯ liá»‡u danh tá»« cÃ³ pháº£i Ä‘Æ°á»£c dá»‹ch hay khÃ´ng
                    */</span>
        <span class="kt">char</span> <span class="n">target_name</span><span class="o">[</span><span class="no">MAX_TARGET_LENGTH</span><span class="o">];</span>
        <span class="kt">int</span> <span class="n">target_list</span><span class="o">[</span><span class="no">MAXPLAYERS</span><span class="o">],</span> <span class="n">target_count</span><span class="o">;</span>
        <span class="n">bool</span> <span class="n">tn_is_ml</span><span class="o">;</span>
    
        <span class="k">if</span> <span class="o">((</span><span class="n">target_count</span> <span class="o">=</span> <span class="nc">ProcessTargetString</span><span class="o">(</span>
                <span class="n">arg1</span><span class="o">,</span>
                <span class="n">client</span><span class="o">,</span>
                <span class="n">target_list</span><span class="o">,</span>
                <span class="no">MAXPLAYERS</span><span class="o">,</span>
                <span class="no">COMMAND_FILTER_ALIVE</span><span class="o">,</span> <span class="cm">/* Chá»‰ cho phÃ©p ngÆ°á»i chÆ¡i cÃ²n sá»‘ng */</span>
                <span class="n">target_name</span><span class="o">,</span>
                <span class="n">sizeof</span><span class="o">(</span><span class="n">target_name</span><span class="o">),</span>
                <span class="n">tn_is_ml</span><span class="o">))</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="cm">/* Chá»©c nÄƒng nÃ y tráº£ lá»i Admin báº±ng thÃ´ng bÃ¡o lá»—i */</span>
            <span class="nc">ReplyToTargetError</span><span class="o">(</span><span class="n">client</span><span class="o">,</span> <span class="n">target_count</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">Plugin_Handled</span><span class="o">;</span>
        <span class="o">}</span>
    
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">target_count</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span>
        <span class="o">{</span>
            <span class="nc">SlapPlayer</span><span class="o">(</span><span class="n">target_list</span><span class="o">[</span><span class="n">i</span><span class="o">],</span> <span class="n">damage</span><span class="o">);</span>
            <span class="nc">LogAction</span><span class="o">(</span><span class="n">client</span><span class="o">,</span> <span class="n">target_list</span><span class="o">[</span><span class="n">i</span><span class="o">],</span> <span class="s">"\"%L\" slapped \"%L\" (damage %d)"</span><span class="o">,</span> <span class="n">client</span><span class="o">,</span> <span class="n">target_list</span><span class="o">[</span><span class="n">i</span><span class="o">],</span> <span class="n">damage</span><span class="o">);</span>
        <span class="o">}</span>
    
        <span class="k">if</span> <span class="o">(</span><span class="n">tn_is_ml</span><span class="o">)</span>
        <span class="o">{</span>
            <span class="nc">ShowActivity2</span><span class="o">(</span><span class="n">client</span><span class="o">,</span> <span class="s">"[SM] "</span><span class="o">,</span> <span class="s">"Slapped %t for %d damage!"</span><span class="o">,</span> <span class="n">target_name</span><span class="o">,</span> <span class="n">damage</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">else</span>
        <span class="o">{</span>
            <span class="nc">ShowActivity2</span><span class="o">(</span><span class="n">client</span><span class="o">,</span> <span class="s">"[SM] "</span><span class="o">,</span> <span class="s">"Slapped %s for %d damage!"</span><span class="o">,</span> <span class="n">target_name</span><span class="o">,</span> <span class="n">damage</span><span class="o">);</span>
        <span class="o">}</span>
    
        <span class="k">return</span> <span class="n">Plugin_Handled</span><span class="o">;</span>
    <span class="o">}</span>

</code></pre></div></div>

<h2 id="events">Events</h2>
<hr />

<p><strong><code class="highlighter-rouge">Events</code></strong> lÃ  cÃ¡c thÃ´ng bÃ¡o <strong><code class="highlighter-rouge">notification</code></strong> thÃ´ng tin Ä‘Æ°á»£c truyá»n giá»¯a cÃ¡c Ä‘á»‘i tÆ°á»£ng trong Server. Nhiá»u cÅ©ng Ä‘Æ°á»£c chuyá»ƒn tá»« Server Ä‘áº¿n Client. ChÃºng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong cÃ¡c <strong><code class="highlighter-rouge">file .res</code></strong> trong thÆ° má»¥c <strong><code class="highlighter-rouge">hl2/resource</code></strong> vÃ  cÃ¡c thÆ° má»¥c <strong><code class="highlighter-rouge">resource</code></strong> cá»§a cÃ¡c mod cá»¥ thá»ƒ. Äá»ƒ biáº¿t danh sÃ¡ch cÆ¡ báº£n, hÃ£y xem <a href="https://wiki.alliedmods.net/Game_Events_(Source)"><strong><code class="highlighter-rouge">Source Game Events</code></strong></a>.</p>

<p>Äiá»u quan trá»ng cáº§n lÆ°u Ã½ má»™t vÃ i khÃ¡i niá»‡m vá» cÃ¡c sá»± kiá»‡n:</p>

<p>â€¢ ChÃºng háº§u nhÆ° luÃ´n luÃ´n cung cáº¥p thÃ´ng tin. Tá»©c lÃ , cháº·n <strong><code class="highlighter-rouge">player_death</code></strong> sáº½ khÃ´ng ngÄƒn má»™t ngÆ°á»i chÆ¡i cháº¿t. NÃ³ cÃ³ thá»ƒ cháº·n tin nháº¯n <strong><code class="highlighter-rouge">HUD</code></strong> hoáº·c <strong><code class="highlighter-rouge">console message</code></strong> hoáº·c thá»© gÃ¬ Ä‘Ã³ nhá».<br />
 â€¢ Há» háº§u nhÆ° luÃ´n sá»­ dá»¥ng cÃ¡c <strong><code class="highlighter-rouge">userids</code></strong> thay vÃ¬ cÃ¡c chá»‰ má»¥c client.<br />
 â€¢ Chá»‰ vÃ¬ nÃ³ náº±m trong má»™t tá»‡p tÃ i nguyÃªn khÃ´ng cÃ³ nghÄ©a lÃ  nÃ³ Ä‘Ã£ tá»«ng Ä‘Æ°á»£c gá»i hoáº·c hoáº¡t Ä‘á»™ng theo cÃ¡ch báº¡n mong Ä‘á»£i. CÃ¡c mod ná»•i tiáº¿ng lÃ  khÃ´ng ghi láº¡i Ä‘Ãºng chá»©c nÄƒng sá»± kiá»‡n cá»§a chÃºng.</p>

<p>An example of finding when a player dies:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">OnPluginStart</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="nc">HookEvent</span><span class="o">(</span><span class="s">"player_death"</span><span class="o">,</span> <span class="n">Event_PlayerDeath</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">Event_PlayerDeath</span><span class="o">(</span><span class="nc">Event</span> <span class="n">event</span><span class="o">,</span> <span class="kd">const</span> <span class="kt">char</span><span class="o">[]</span> <span class="n">name</span><span class="o">,</span> <span class="n">bool</span> <span class="n">dontBroadcast</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="kt">int</span> <span class="n">victim_id</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">GetInt</span><span class="o">(</span><span class="s">"userid"</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">attacker_id</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">GetInt</span><span class="o">(</span><span class="s">"attacker"</span><span class="o">);</span>
        
        <span class="kt">int</span> <span class="n">victim</span> <span class="o">=</span> <span class="nc">GetClientOfUserId</span><span class="o">(</span><span class="n">victim_id</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">attacker</span> <span class="o">=</span> <span class="nc">GetClientOfUserId</span><span class="o">(</span><span class="n">attacker_id</span><span class="o">);</span>
        
        <span class="cm">/* CODE */</span>
    <span class="o">}</span>

</code></pre></div></div>
:ET